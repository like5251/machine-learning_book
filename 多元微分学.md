# 多元微分学
实际应用中的函数普遍包含多个变量，当进入高维时，微积分的普遍法则本质上保持原样，虽然必须引入一些新的记号，但幸运的是并不需要彻底改造原有理论，多变量微积分无非是同时在各个方向运用单变量微积分（向量和矩阵表示将大大简化多元微积分，并能保持与低维形式上的一致性）。

本文使用小写字母$$x$$表示标量，粗体小写字母$$\boldsymbol{x}$$表示向量，大写字母$$X$$表示矩阵。

## 梯度（Gradient）

### 多元函数
定义：$$f:\boldsymbol{x}\rightarrow y$$，其中$$\boldsymbol{x}=(x_{1},x_{2},...,x_{n})\in \mathbb{R}^{n}$$，$$y\in \mathbb{R}$$。多元函数是从n维空间（n维向量）到一维空间（标量）的映射。

### 等高线图

定义：对于二元函数$$f(x,y)$$，曲线$$f(x,y)=z_{0}$$称为函数f在平面$$z=z_{0}$$中的等高线。如果所有等高线$$z=z_{0}$$都被投射到$$x-y$$平面上，则得到这个曲面的等高线图。
![](/assets/等高线.png)
### 梯度（向量）
定义：$$f$$在点$$\boldsymbol{x}$$处的梯度是由对应维度的偏导构成向量，记作$$\bigtriangledown f(\boldsymbol{x})$$，读作grad f或del f。

$$
\triangledown f(\boldsymbol{x}) = \begin{bmatrix}
\frac{\partial f}{\partial x_{i}}
\end{bmatrix}_{n\times 1}
$$

性质：
- 梯度是标量对向量的导数；
- 梯度是输入空间中的一个偏导向量；
- 梯度的方向是在输入空间中使函数增长最快的方向；
- 梯度的大小是函数关于输入向量的最大变化率；
- 梯度也称为**全导数**，记做$$f^{'}(\boldsymbol{x})$$

$$
f^{'}(\boldsymbol{x})=\triangledown f(\boldsymbol{x}) = \begin{bmatrix}
\frac{\partial f}{\partial x_{i}}
\end{bmatrix}_{n\times 1}\\
f(\boldsymbol{x}) \approx f(\boldsymbol{x_{0}})+f^{'}(\boldsymbol{x_{0}})^{T}(\boldsymbol{x}-\boldsymbol{x_{0}})
$$

### 全微分
定义：多元函数全增量$$\triangle f$$的线性主部，记做$$df$$。

$$
\triangle f=\sum_{i=1}^{n}a_{i}\triangle x_{i}+o(\rho )\\
df=\sum_{i=1}^{n}\frac{\partial f}{\partial x_{i}}dx_{i} =\triangledown f(\boldsymbol{x})\cdot d\boldsymbol{x}
$$

梯度-全导数-全微分-偏导之间的关系如下：
$$
\triangledown f(\boldsymbol{x})=f^{'}(\boldsymbol{x})=\frac{\mathrm{d} f}{\mathrm{d} \boldsymbol{x}}=\begin{bmatrix}
\frac{\partial f}{\partial x_{i}}
\end{bmatrix}_{n\times 1}

$$

### 方向导数
定义：设$$\mathbf{\mathit{u}}$$为单位向量，$$f$$在该方向上的方向导数（变化率）记做$$\frac{\partial f}{\partial \mathbf{\mathit{u}}}$$。

$$
\begin{align*}
\frac{\partial f(\boldsymbol{x})}{\partial \boldsymbol{u}}&=\lim_{h\rightarrow 0}\frac{f(\boldsymbol{x}+h\boldsymbol{u})-f(\boldsymbol{x})}{h}\\
&=\triangledown f(\boldsymbol{x})\cdot \boldsymbol{u}\\
&=|\triangledown f(\boldsymbol{x})|cos\theta 
\end{align*}
$$


性质：
- 方向导数是梯度向量在该方向上的投影；
- 梯度方向的方向导数最大，即函数在梯度方向上增长最快；
- 在负梯度方向上，函数下降最快；

## 海塞矩阵（Hessian Matrix）
定义：海塞矩阵是一个多元函数的二阶偏导数构成的对称方阵，描述了函数的局部曲率。

$$
H(f)=\begin{bmatrix}
\frac{\partial f}{\partial x_{i} \partial x_{j}}
\end{bmatrix}_{n\times n}
$$

完整写作：

![](/assets/hessian.svg)

### 利用海赛矩阵判定多元函数极值

定理：设n元函数$$f(x_{1},x_{2},...,x_{n})$$在点 $$M_{0}(a_{1},a_{2},...,a_{n})$$的邻域内有二阶连续偏导，如果f在该点梯度为0，则可以通过该点的二阶偏导即海塞矩阵H判断函数在该点是否取得极值。

1. 如果H为正定矩阵，函数在该点取得极小值；
2. 如果H为负正定矩阵，函数在该点取得极大值；
3. 如果H是半正定或半负定，该点是可疑极值点，需更通过其他方法来判定；
4. 如果H是不定矩阵，该点不是极值点；

海塞矩阵的用途：
1. 用于多元泰勒展开；
2. 用于牛顿法解决最优化问题；

## 多元泰勒展开
在工程实际问题的优化设计中，所列的目标函数往往很复杂，为了使问题简化，常常将目标函数在某点邻域展开成泰勒多项式来逼近原函数。

$$
f(\boldsymbol{x})=f(\boldsymbol{x_{0}})+\triangledown f(\boldsymbol{x_{0}})^{T}(\boldsymbol{x}-\boldsymbol{x_{0}})+\frac{1}{2}(\boldsymbol{x}-\boldsymbol{x_{0}})^{T}H(\boldsymbol{x_{0}})(\boldsymbol{x}-\boldsymbol{x_{0}})+...
$$

- $$\triangledown f(\boldsymbol{x_{0}})$$是$$f$$在$$\boldsymbol{x_{0}}$$处的梯度
- $$H(\boldsymbol{x_{0}})$$是$$f$$在$$\boldsymbol{x_{0}}$$处的海塞矩阵


## 矩阵求导
这里主要参考了知乎上的两篇文章，并重新整理了标量对矩阵求导的部分。
1. [矩阵求导术（上）](https://zhuanlan.zhihu.com/p/24709748)
2. [矩阵求导术（下）](https://zhuanlan.zhihu.com/p/24863977)

### 























